<!DOCTYPE html>
<html lang="pl">
<!-- ==================== HEAD ==================== -->
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ü¶Ü DuckOnBoard - Find Your Perfect Board</title>
	

    <!-- ==================== Version ==================== -->
	    <!-- 
    WERSJA: 1.7
    DATA: 2026-02-11
    ZMIANY:
    - Dodano Firebase Authentication (Google, Email, Anonymous)
    - Dodano obrazki do kategorii (8 PNG)
    - Dodano wylogowanie w Settings
    
    CHANGELOG:
    v1.0 (2026-02-05) - Podstawowa struktura, formularze
    v1.1 (2026-02-08) - Algorytmy snowboard/ski
    v1.2 (2026-02-09) - Kalkulator DIN
    v1.5 (2026-02-10) - Firebase + obrazki
	v1.6 (2026-02-11) - komentarze w kodzie html
	v1.6 (2026-02-12) - pakiet logowania dla biznesu
    -->
	
	<!-- ==================== STYLES ==================== -->
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Arial, sans-serif;
            background: #0A0A0A;
            color: #FFFFFF;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: flex-start;
            padding: 20px;
            overflow-y: auto;
        }

        /* THEME SYSTEM */
        body.theme-standard-dark {
            background: #0A0A0A;
        }

        body.theme-standard-dark .app-container {
            background: #0A0A0A;
            color: #FFFFFF;
        }

        body.theme-standard-light {
            background: #F5F5F5;
        }

        body.theme-standard-light .app-container {
            background: #FFFFFF;
            color: #0A0A0A;
        }

        body.theme-pride {
            background: linear-gradient(135deg, #FF0080 0%, #FF8C00 25%, #FFED00 50%, #00FF00 75%, #0080FF 100%);
        }

        body.theme-pride .app-container {
            background: #1A1A1A;
            color: #FFFFFF;
            border: 3px solid rgba(255, 255, 255, 0.3);
        }

        .app-container {
            width: 100%;
            max-width: 420px;
            background: #0A0A0A;
            border-radius: 40px;
            box-shadow: 0 20px 60px rgba(0, 217, 255, 0.3);
            overflow: visible;
            position: relative;
        }

        /* Settings Button */
        .settings-btn {
            position: fixed;
            top: 30px;
            right: 30px;
            width: 50px;
            height: 50px;
            background: rgba(0, 217, 255, 0.2);
            border: 2px solid #00D9FF;
            border-radius: 50%;
            font-size: 24px;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            backdrop-filter: blur(10px);
        }

        .settings-btn:hover {

        /* ==================== CSS: Reset & Variables ==================== */
            background: rgba(0, 217, 255, 0.3);
            transform: rotate(90deg);
        }

        /* Settings Modal */
        .settings-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 2000;
            align-items: center;
            justify-content: center;
        }

        .settings-modal.active {
            display: flex;
        }

        .settings-content {
            background: #1A1A1A;
            border-radius: 24px;
            padding: 30px;
            max-width: 400px;
            width: 90%;
        }

        body.theme-standard-light .settings-content {
            background: #FFFFFF;
        }

        .settings-content h2 {
            margin-bottom: 20px;
            color: #00D9FF;
        }

        .modal-section {
            margin-bottom: 25px;
        }

        .modal-section h3 {
            font-size: 16px;
            margin-bottom: 12px;
            color: #B0B0B0;
        }

        .theme-option {
            padding: 15px;
            background: #0A0A0A;
            border: 2px solid #333;
            border-radius: 12px;
            margin-bottom: 10px;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.2s;
        }

        body.theme-standard-light .theme-option {
            background: #F5F5F5;
            border-color: #CCC;
        }

        .theme-option:hover {
            border-color: #00D9FF;
        }

        .theme-option.active {
            border-color: #00D9FF;
            background: rgba(0, 217, 255, 0.1);
        }

        .checkmark {
            display: none;
            color: #00D9FF;
        }
		.theme-option span {
			color: #FFFFFF;
		}

		body.theme-standard-light .theme-option span {
			color: #0A0A0A;
		}
        .theme-option.active .checkmark {
            display: block;
        }

        /* CRITICAL FIX: Mobile scroll */
        .screen {
            display: none;
            min-height: auto;
            height: auto;
            overflow-y: auto;
            padding-bottom: 60px;
        }


		/* ==================== CSS: Business Register ==================== */
		.biz-step {
			padding: 20px;
		}

		.biz-type-selected {
			border: 2px solid #00D9FF !important;
			background: rgba(0, 217, 255, 0.1) !important;
		}

		.biz-cat-selected {
			border: 2px solid #00D9FF !important;
			background: rgba(0, 217, 255, 0.1) !important;
		}

		.form-group {
			margin-bottom: 16px;
		}

		textarea.form-input {
			resize: vertical;
			min-height: 80px;
			font-family: inherit;
		}

        /* ==================== CSS: Theme System ==================== */
        .screen.active {
            display: block;
        }

        .header {
            padding: 20px;
            text-align: center;
            border-bottom: 1px solid #1A1A1A;
            position: sticky;
            top: 0;
            background: #0A0A0A;
            z-index: 10;
        }

        body.theme-standard-light .header {
            border-bottom-color: #E0E0E0;
            background: #FFFFFF;
        }

        body.theme-pride .header {
            background: #1A1A1A;
        }

        .header-nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .btn-back {
            background: none;
            border: none;
            font-size: 28px;
            color: #00D9FF;
            cursor: pointer;
            padding: 5px 10px;
            transition: transform 0.2s;
        }

        .btn-back:hover {
            transform: translateX(-5px);
        }

        .progress-indicator {
            font-size: 14px;
            color: #666;
        }

        .header-title {
            font-size: 24px;
            font-weight: 700;
        }

        body.theme-standard-light .header-title {
            color: #0A0A0A;
        }

        .logo-container {
            text-align: center;
            padding: 40px 20px 20px;
        }

        .logo {
            margin-bottom: 15px;
        }

        .logo img {
            width: 120px;
            height: 120px;
            object-fit: contain;
        }

        .app-name {
            font-size: 36px;
            font-weight: 800;
            background: linear-gradient(135deg, #00D9FF 0%, #00B8D4 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 5px;
        }

        .tagline {
            font-size: 16px;
            color: #B0B0B0;
            font-weight: 300;
        }

        .content {
            padding: 20px;
            padding-bottom: 80px;
        }

        /* Categories Grid */
        /* KATEGORIE - Wariant 4 (czysty) */
        .categories-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;

        /* ==================== CSS: Settings Modal ==================== */
            padding: 20px;
        }

        .category-card {
            background: #1A1A1A;
            border-radius: 20px;
            overflow: hidden;
            cursor: pointer;
            transition: all 0.3s;
            border: 2px solid #333;
            display: flex;
            flex-direction: column;
        }

        .category-card:hover {
            transform: translateY(-5px);
            border-color: #00D9FF;
            box-shadow: 0 10px 30px rgba(0, 217, 255, 0.3);
        }

        .category-card.inactive {
            opacity: 0.5;
            cursor: not-allowed;
        }

        body.theme-standard-light .category-card {
            background: #F5F5F5;
            border-color: #CCC;
        }

        .category-card .category-image {
            width: 100%;
            aspect-ratio: 1;
            overflow: hidden;
        }

        .category-card .category-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.3s;
        }

        .category-card:hover .category-image img {
            transform: scale(1.05);
        }

        .category-card .category-icon {
            display: none;
        }

        .category-card .category-name {
            padding: 12px;
            font-size: 14px;
            font-weight: 600;
            text-align: center;
            background: #0A0A0A;
            color: #FFFFFF;
        }

        body.theme-standard-light .category-card .category-name {
            background: #E0E0E0;
            color: #0A0A0A;
        }

        .category-card .category-badge {
            position: absolute;
            top: 10px;
            right: 10px;
            background: rgba(0, 0, 0, 0.7);
            padding: 4px 10px;
            border-radius: 8px;
            font-size: 10px;
            font-weight: 700;
            color: #FFD700;
            display: none;
        }

        /* Category colors */
        .category-snowboard {
            background: linear-gradient(135deg, #00D9FF 0%, #0099CC 100%);
        }

        .category-ski {
            background: linear-gradient(135deg, #0099FF 0%, #0066CC 100%);
        }

        .category-kite {
            background: linear-gradient(135deg, #FF9944 0%, #CC7722 100%);
        }

        .category-wake {
            background: linear-gradient(135deg, #9966FF 0%, #6633CC 100%);
        }

        .category-surf {
            background: linear-gradient(135deg, #00CCAA 0%, #009988 100%);
        }

        .category-sup {

        /* ==================== CSS: Screens & Layout ==================== */
            background: linear-gradient(135deg, #44CC44 0%, #339933 100%);
        }

        .category-tennis {
            background: linear-gradient(135deg, #FF6699 0%, #CC4477 100%);
        }

        .category-bike {
            background: linear-gradient(135deg, #FF4444 0%, #CC2222 100%);
        }

        /* AdMob Banner */
        .admob-banner {
            height: 50px;
            background: #1A1A1A;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #666;
            font-size: 12px;
            border: 1px dashed #333;
            margin-bottom: 20px;
        }

        body.theme-standard-light .admob-banner {
            background: #F0F0F0;
            border-color: #CCC;
        }

        .admob-banner.hidden {
            display: none;
        }

        /* BUTTON FIXES */
        .btn {
            width: 100%;
            padding: 16px;
            border-radius: 16px;
            border: none;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            margin-bottom: 12px;
            position: relative;
        }

        .btn * {
            pointer-events: none;
        }

        .btn-primary {
            background: linear-gradient(135deg, #00D9FF 0%, #00B8D4 100%);
            color: #0A0A0A;
            box-shadow: 0 8px 24px rgba(0, 217, 255, 0.4);
        }

        .btn-primary:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 12px 32px rgba(0, 217, 255, 0.5);
        }

        .btn-primary:disabled {
            background: #333333;
            color: #666666;
            opacity: 0.6;
            cursor: not-allowed;
            box-shadow: none;
            pointer-events: all;
        }

        body.theme-pride .btn-primary:not(:disabled) {
            background: linear-gradient(135deg, #FF0080 0%, #FF8C00 25%, #FFED00 50%, #00FF00 75%, #0080FF 100%);
            color: #FFFFFF;
        }

        .btn-secondary {
            background: #1A1A1A;
            color: #FFFFFF;
            border: 2px solid #333;
        }

        body.theme-standard-light .btn-secondary {
            background: #F5F5F5;
            color: #0A0A0A;
            border-color: #CCC;
        }

        .btn-secondary:hover {
            border-color: #00D9FF;
            background: #222;
        }

        body.theme-standard-light .btn-secondary:hover {
            background: #E8E8E8;

        /* ==================== CSS: Forms & Inputs ==================== */
        }

        .btn-skip {
            background: none;
            border: none;
            color: #999;
            font-size: 14px;
            cursor: pointer;
            padding: 12px 20px;
            margin-bottom: 10px;
            opacity: 0.7;
            transition: opacity 0.3s;
            width: 100%;
        }

        .btn-skip * {
            pointer-events: none;
        }

        .btn-skip:hover {
            opacity: 1;
        }

        .btn-skip:disabled {
            opacity: 0.3;
            cursor: not-allowed;
        }

        .divider {
            display: flex;
            align-items: center;
            gap: 16px;
            margin: 20px 0;
        }

        .divider-line {
            flex: 1;
            height: 1px;
            background: #333;
        }

        body.theme-standard-light .divider-line {
            background: #CCC;
        }

        .divider-text {
            color: #666;
            font-size: 14px;
            font-weight: 500;
        }

        .benefits {
            text-align: center;
            margin: 20px 0;
        }

        .benefits-title {
            font-size: 14px;
            color: #B0B0B0;
            margin-bottom: 12px;
        }

        .benefit-item {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            font-size: 14px;
            color: #00D9FF;
            margin-bottom: 8px;
        }

        /* Form Elements */
        .form-group {
            margin-bottom: 30px;
        }

        .form-label {
            display: block;
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 12px;
            color: #FFFFFF;
        }

        body.theme-standard-light .form-label {
            color: #0A0A0A;
        }

        .form-hint {
            font-size: 13px;
            color: #999;
            margin-top: 8px;
            line-height: 1.4;
        }

        /* Radio buttons */
        .radio-group {
            display: flex;
            flex-direction: column;

        /* ==================== CSS: Buttons ==================== */
            gap: 12px;
        }

        .radio-option {
            display: flex;
            align-items: center;
            padding: 12px 16px;
            border-radius: 12px;
            border: 2px solid #333;
            cursor: pointer;
            transition: all 0.2s;
        }

        body.theme-standard-light .radio-option {
            border-color: #CCC;
        }

        .radio-option:hover {
            border-color: #00D9FF;
        }

        .radio-option input[type="radio"] {
            margin-right: 12px;
            width: 20px;
            height: 20px;
            cursor: pointer;
        }

        .radio-option.checked {
            border-color: #00D9FF;
            background: rgba(0, 217, 255, 0.1);
        }

        .slider-group {
            display: flex;
            gap: 15px;
            align-items: center;
        }

        .slider-value-display {
            min-width: 80px;
            padding: 12px 16px;
            background: #1A1A1A;
            border-radius: 12px;
            text-align: center;
            font-size: 18px;
            font-weight: 700;
            color: #00D9FF;
            border: 2px solid #333;
        }

        body.theme-standard-light .slider-value-display {
            background: #F5F5F5;
            border-color: #CCC;
            color: #0A0A0A;
        }

        input[type="range"] {
            flex: 1;
            height: 8px;
            border-radius: 4px;
            background: #1A1A1A;
            outline: none;
            -webkit-appearance: none;
        }

        body.theme-standard-light input[type="range"] {
            background: #E0E0E0;
        }

        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: #00D9FF;
            cursor: pointer;
        }

        input[type="range"]::-moz-range-thumb {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: #00D9FF;
            cursor: pointer;
            border: none;
        }

        input[type="number"],
        input[type="text"] {
            width: 100%;
            padding: 14px 16px;
            font-size: 16px;
            background: #1A1A1A;
            border: 2px solid #333;
            border-radius: 12px;
            color: #FFFFFF;
            transition: all 0.2s;
        }

        /* ==================== CSS: Categories Grid ==================== */

        body.theme-standard-light input[type="number"],
        body.theme-standard-light input[type="text"] {
            background: #F5F5F5;
            border-color: #CCC;
            color: #0A0A0A;
        }

        input:focus {
            outline: none;
            border-color: #00D9FF;
        }

        /* Cards */
        .card {
            background: #1A1A1A;
            border: 2px solid #222;
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 12px;
            cursor: pointer;
            transition: all 0.3s;
            position: relative;
        }

        body.theme-standard-light .card {
            background: #F5F5F5;
            border-color: #E0E0E0;
        }

        .card:hover {
            border-color: #00D9FF;
            transform: translateY(-2px);
        }

        .card.selected {
            border-color: #00D9FF;
            border-width: 3px;
            background: rgba(0, 217, 255, 0.1);
        }

        .card-icon {
            font-size: 32px;
            margin-bottom: 10px;
        }

        .card-title {
            font-size: 18px;
            font-weight: 700;
            margin-bottom: 5px;
        }

        body.theme-standard-light .card-title {
            color: #0A0A0A;
        }

        .card-description {
            font-size: 14px;
            color: #666;
            line-height: 1.4;
        }

		body.theme-standard-light .card-description {
			color: #555; /* Ciemniejszy dla lepszej widoczno≈õci */
		}
        .card-checkmark {
            position: absolute;
            top: 20px;
            right: 20px;
            font-size: 24px;
            color: #00D9FF;
            display: none;
        }

        .card.selected .card-checkmark {
            display: block;
        }

        /* Results */
        .result-main {
            text-align: center;
            padding: 30px 20px;
            background: #1A1A1A;
            border-radius: 16px;
            margin-bottom: 20px;
        }

        body.theme-standard-light .result-main {
            background: #F5F5F5;
        }

        .result-label {
            font-size: 12px;
            color: #666;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 10px;
        }

        .result-value {
            font-size: 64px;
            font-weight: 800;
            color: #00D9FF;
            line-height: 1;
        }

        .result-unit {
            font-size: 32px;
            color: #666;
        }

        .result-range {
            font-size: 16px;
            color: #B0B0B0;
            margin-top: 10px;
        }

        .result-advice {
            background: #1A1A1A;
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 20px;
        }

        body.theme-standard-light .result-advice {
            background: #F5F5F5;
        }

        .result-advice h3 {
            font-size: 16px;
            margin-bottom: 15px;
            color: #00D9FF;
        }

        .result-advice-item {
            display: flex;
            align-items: flex-start;
            gap: 10px;
            margin-bottom: 10px;
            font-size: 14px;
            line-height: 1.5;
        }

        body.theme-standard-light .result-advice-item {
            color: #0A0A0A;
        }

        .gender-hint {
            padding: 16px;
            background: rgba(255, 165, 0, 0.1);
            border-radius: 12px;
            margin: 16px 0;
            font-size: 14px;
            color: #FFA500;
            line-height: 1.5;
        }

        .action-buttons {
            display: flex;
            flex-direction: column;
            gap: 12px;
            margin-top: 24px;
        }

        .btn-action {
            padding: 16px;
            border-radius: 12px;
            border: 2px solid #333;
            background: #1A1A1A;
            color: #FFF;
            font-size: 15px;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        body.theme-standard-light .btn-action {
            background: #F5F5F5;
            border-color: #CCC;
            color: #0A0A0A;
        }

        .btn-action:hover {
            border-color: #00D9FF;
            background: rgba(0, 217, 255, 0.1);
        }

        .toggle-technical {
            width: 100%;
            padding: 12px;
            background: #1A1A1A;
            border: 1px solid #333;
            border-radius: 8px;
            color: #00D9FF;
            font-size: 14px;
            cursor: pointer;
            margin-bottom: 16px;

        /* ==================== CSS: Email Form ==================== */
        }

        body.theme-standard-light .toggle-technical {
            background: #F5F5F5;
            border-color: #CCC;
        }

        .tech-params {
            display: none;
            background: #1A1A1A;
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 20px;
        }

        body.theme-standard-light .tech-params {
            background: #F5F5F5;
        }

        .tech-params.visible {
            display: block;
        }

        .param-item {
            display: flex;
            justify-content: space-between;
            padding: 12px 0;
            border-bottom: 1px solid #333;
        }

        body.theme-standard-light .param-item {
            border-bottom-color: #E0E0E0;
        }

        .param-item:last-child {
            border-bottom: none;
        }

        .param-label {
            color: #999;
            font-size: 14px;
        }

        .param-value {
            color: #FFFFFF;
            font-size: 14px;
            font-weight: 600;
        }

        body.theme-standard-light .param-value {

        /* ==================== CSS: User Account Section ==================== */
            color: #0A0A0A;
        }

        .footer {
            text-align: center;
            padding: 20px;
            font-size: 12px;
            color: #666;
        }

        .footer a {
            color: #00D9FF;
            text-decoration: none;
        }

        /* Toast */
        .toast {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: #00D9FF;
            color: #0A0A0A;
            padding: 12px 24px;
            border-radius: 8px;
            font-weight: 600;
            z-index: 3000;
            opacity: 0;
            transition: opacity 0.3s;
            pointer-events: none;
        }

        .toast.show {
            opacity: 1;
        }

        /* Responsive */
        @media (max-width: 375px) {
            .category-icon {
                font-size: 48px;
            }
            
            .category-name {
                font-size: 14px;
            }
            
            .categories-grid {
                gap: 12px;
            }
        }
		/* Obrazki w kategoriach - Wariant 4 */
        .category-card .category-image {
            width: 100%;
            aspect-ratio: 1;
            overflow: hidden;
            border-radius: 16px 16px 0 0;
        }

        .category-card .category-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.3s;
        }

        .category-card:hover .category-image img {
            transform: scale(1.05);
        }

        .category-card .category-icon {
            display: none; /* Ukrywamy emoji gdy sƒÖ obrazki */
        }

        .category-card .category-name {
            padding: 16px;
            font-size: 16px;
            font-weight: 700;
            text-align: center;
        }
		
		/* User Account Section in Settings */
        .user-account-section {
            border-top: 1px solid #333;
            padding-top: 20px;
            margin-top: 20px;
        }

        body.theme-standard-light .user-account-section {
            border-top-color: #CCC;
        }

        .user-info-display {
            background: rgba(0, 217, 255, 0.1);
            border-radius: 12px;
            padding: 15px;
            margin-bottom: 15px;
        }

        .user-name-display {
            font-size: 16px;
            font-weight: 600;
            color: #00D9FF;
            margin-bottom: 5px;
        }

        .user-email-display {
            font-size: 14px;
            color: #B0B0B0;
        }

        .btn-logout {
            width: 100%;
            padding: 15px;
            background: #FF4444;
            border: none;
            border-radius: 12px;
            color: white;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn-logout:hover {
            background: #FF6666;
            transform: translateY(-2px);
        }
		
		/* Email Form */

<!-- ==================== BODY ==================== -->
        .email-form-section {
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid #333;
        }

    <!-- ==================== SETTINGS MODAL ==================== -->

        .email-form {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .input-field {
            width: 100%;
            padding: 14px;
            background: #1A1A1A;
            border: 2px solid #333;
            border-radius: 12px;
            font-size: 15px;
            color: #FFFFFF;
            transition: all 0.3s;
        }

        body.theme-standard-light .input-field {
            background: #F5F5F5;
            border-color: #CCC;
            color: #0A0A0A;
        }

        .input-field:focus {
            outline: none;
            border-color: #00D9FF;
            box-shadow: 0 0 0 3px rgba(0, 217, 255, 0.1);
        }

        .toggle-auth-mode {
            margin-top: 12px;
            text-align: center;

    <!-- ==================== TOAST NOTIFICATIONS ==================== -->
            font-size: 14px;
            color: #B0B0B0;
            cursor: pointer;

    <!-- ==================== APP CONTAINER ==================== -->
        }
        <!-- -------------------- SCREEN: Launch (Login) -------------------- -->


        <!-- ==================== SCREENS ==================== -->
        .toggle-auth-mode span {
            color: #00D9FF;
            text-decoration: underline;
        }

        .toggle-auth-mode:hover span {
            color: #7B68EE;
        }

        .error-message {
            background: rgba(255, 71, 87, 0.1);
            border: 2px solid #FF4757;
            color: #FF4757;
            padding: 10px;
            border-radius: 10px;
            font-size: 13px;
            text-align: center;
        }
    </style>
</head>
<body class="theme-standard-dark">
    <!-- Settings Button -->
    <button class="settings-btn" onclick="openSettings()">‚öôÔ∏è</button>

    <!-- Settings Modal -->
    <div class="settings-modal" id="settingsModal">
        <div class="settings-content">
            <h2>‚öôÔ∏è Ustawienia</h2>
            
            <div class="modal-section">
                <h3>üé® Motyw</h3>
                <div class="theme-option active" onclick="changeTheme('standard-dark')" data-theme="standard-dark">
                    <span>Standard Dark</span>
                    <span class="checkmark">‚úì</span>
                </div>
                <div class="theme-option" onclick="changeTheme('standard-light')" data-theme="standard-light">
                    <span>Standard Light</span>
                    <span class="checkmark">‚úì</span>
                </div>
                <div class="theme-option" onclick="changeTheme('pride')" data-theme="pride">
                    <span>üåà Pride</span>
                    <span class="checkmark">‚úì</span>
                </div>
            </div>
			<div class="modal-section user-account-section" id="userAccountSection" style="display: none;">
                <h3>TWOJE KONTO</h3>
                <div class="user-info-display" id="userInfoDisplay">
                    <div class="user-name-display" id="userNameDisplay">≈Åadowanie...</div>
                    <div class="user-email-display" id="userEmailDisplay"></div>
                </div>
                <button class="btn-logout" id="logoutBtnSettings" onclick="handleLogout()">üö™ Wyloguj siƒô</button>
            </div>

            <button class="btn btn-primary" onclick="closeSettings()">Zamknij</button>
        </div>
    </div>

    <!-- Toast -->

        <!-- -------------------- SCREEN: Categories -------------------- -->
    <div class="toast" id="toast"></div>

    <!-- App Container -->
    <div class="app-container">
        <!-- SCREEN 1: LAUNCH + LOGIN -->
        <div class="screen active" id="screen-launch">
            <div class="logo-container">
                <div class="logo">
                    <img id="mainLogo" src="logo-standard.png" alt="DuckOnBoard Logo" onerror="this.style.display='none'; this.parentElement.innerHTML='ü¶Ü';">
                </div>
                <h1 class="app-name">DuckOnBoard</h1>
                <p class="tagline">Find Your Perfect Board</p>
            </div>

            <div class="content">
                <button class="btn btn-primary" onclick="startAnonymous()">
                    <span>‚ö°</span>
                    <span>U≈ºyj bez logowania</span>
                </button>

                <div class="divider">
                    <div class="divider-line"></div>
                    <span class="divider-text">Lub zaloguj siƒô</span>
                    <div class="divider-line"></div>
                </div>

                <div class="benefits">
                    <p class="benefits-title">üí∞ Rabaty i promocje czekajƒÖ!</p>
                    <div class="benefit-item">
                        <span>‚úì</span>
                        <span>Bez reklam na formularzach</span>
                    </div>
                    <div class="benefit-item">
                        <span>‚úì</span>
                        <span>Historia w chmurze</span>
                    </div>
                    <div class="benefit-item">
                        <span>‚úì</span>
                        <span>Powiadomienia o wyprzeda≈ºach</span>
                    </div>
                </div>

                <button class="btn btn-secondary" onclick="loginGoogle()">
                    <span>G</span>
                    <span>Zaloguj przez Google</span>
                </button>
                <button class="btn btn-secondary" onclick="loginFacebook()">
                    <span>f</span>
                    <span>Zaloguj przez Facebook</span>
                </button>
                <button class="btn btn-secondary" onclick="loginApple()">
                    <span>üçé</span>
                    <span>Zaloguj przez Apple</span>
                </button>
				<button class="btn btn-secondary" onclick="showEmailForm()">
					<span>üìß</span>
					<span>Zaloguj przez Email</span>
				</button>

				<!-- Formularz Email (ukryty domy≈õlnie) -->

        <!-- -------------------- SCREEN: Form 1 (Physical Data) -------------------- -->
				<div id="emailFormSection" class="email-form-section" style="display: none;">
					<div class="email-form">
						<input type="email" id="emailInput" class="input-field" placeholder="Tw√≥j email">
						<input type="password" id="passwordInput" class="input-field" placeholder="Has≈Ço (min. 6 znak√≥w)">
						<button class="btn btn-primary" id="emailAuthBtn" onclick="handleEmailAuth()">Zaloguj siƒô</button>
						<div id="errorMessage" class="error-message" style="display: none;"></div>
					</div>
					<div class="toggle-auth-mode" onclick="toggleAuthMode()">
						Nie masz konta? <span id="toggleText">Zarejestruj siƒô</span>
					</div>				
				</div>
            </div>
			<div style="text-align: center; margin-top: 20px; padding-top: 20px; border-top: 1px solid #333;">
				<p style="color: #B0B0B0; font-size: 14px; margin-bottom: 12px;">Jeste≈õ wypo≈ºyczalniƒÖ, instruktorem lub sklepem?</p>
				<button class="btn btn-secondary" onclick="goToScreen('business-register')" style="width: 100%;">
					üè¢ Zarejestruj konto biznesowe
				</button>
			</div>
            <div class="footer">
                <a href="#">Privacy Policy</a> ¬∑ 
                <a href="#">Terms</a> ¬∑ 
                <a href="#">Contact</a>
            </div>
        </div>

        <!-- SCREEN 2: CATEGORIES -->
        <div class="screen" id="screen-categories">
            <div class="logo-container" style="padding: 30px 20px;">
                <div class="logo">
                    <img src="logo-standard.png" alt="Logo" style="width: 80px; height: 80px;" onerror="this.innerHTML='ü¶Ü'; this.style.fontSize='64px';">
                </div>
                <h2 style="font-size: 24px; margin: 16px 0 8px;">Wybierz kategoriƒô:</h2>
            </div>

            <div class="categories-grid">
                <div class="category-card active category-snowboard" onclick="selectCategory('snowboard')">
                    <div class="category-image">
                        <img src="button_category_snowboard.png" alt="Snowboard">
                    </div>
                    <div class="category-name">Snowboard</div>
                </div>
                
                <div class="category-card active category-ski" onclick="selectCategory('ski')">
                    <div class="category-image">
                        <img src="button_category_ski.png" alt="Ski">
                    </div>
                    <div class="category-name">Ski</div>
                </div>
                
                <div class="category-card inactive category-kite">
                    <div class="category-image">
                        <img src="button_category_katesurfing.png" alt="Kitesurfing">
                    </div>
                    <div class="category-name">Kitesurfing ‚Äî Soon</div>
                </div>
                
                <div class="category-card inactive category-wake">
                    <div class="category-image">
                        <img src="button_category_Wake.png" alt="Wakeboard">
                    </div>
                    <div class="category-name">Wakeboard ‚Äî Soon</div>
                </div>
                
                <div class="category-card inactive category-surf">
                    <div class="category-image">
                        <img src="button_category_Surfing.png" alt="Surfing">
                    </div>
                    <div class="category-name">Surfing ‚Äî Soon</div>
                </div>
                
                <div class="category-card inactive category-sup">
                    <div class="category-image">
                        <img src="button_category_Sup.png" alt="SUP">
                    </div>
                    <div class="category-name">SUP ‚Äî Soon</div>

        <!-- -------------------- SCREEN: Form 2 (Level) -------------------- -->
                </div>
                
                <div class="category-card inactive category-skate">
                    <div class="category-image">
                        <img src="button_category_skate.png" alt="Skateboard">
                    </div>
                    <div class="category-name">Skateboard ‚Äî Soon</div>
                </div>
                
                <div class="category-card inactive category-wind">
                    <div class="category-image">
                        <img src="button_category_Windsurfing.png" alt="Windsurfing">
                    </div>
                    <div class="category-name">Windsurfing ‚Äî Soon</div>
                </div>
            </div>
        </div>

        <!-- SCREEN 3: FORM 1/3 - BASIC DATA + GENDER -->
        <div class="screen" id="screen-form1">
            <div class="header">
                <div class="header-nav">
                    <button class="btn-back" onclick="goBack()">‚Üê</button>
                    <span class="progress-indicator">[1/3]</span>
                    <div style="width:30px"></div>
                </div>
                <h2 class="header-title">O Tobie</h2>
            </div>

            <div class="content">
                <div class="admob-banner" id="ad-form1">üì± AdMob Banner 300x50</div>

                <!-- GENDER (OPTIONAL) -->
                <div class="form-group">
                    <label class="form-label">Kim jeste≈õ? (opcjonalnie)</label>
                    <div class="radio-group">
                        <label class="radio-option">
                            <input type="radio" name="gender" value="female" onchange="updateRadioStyle()">
                            <span>Kobieta</span>
                        </label>

        <!-- -------------------- SCREEN: Form 3 (Style) -------------------- -->
                        <label class="radio-option">
                            <input type="radio" name="gender" value="male" onchange="updateRadioStyle()">
                            <span>Mƒô≈ºczyzna</span>
                        </label>
                        <label class="radio-option">
                            <input type="radio" name="gender" value="other" onchange="updateRadioStyle()">
                            <span>Inne / Wolƒô nie podawaƒá</span>
                        </label>
                    </div>
                    <p class="form-hint">üí° Pomaga dok≈Çadniej dobraƒá d≈Çugo≈õƒá<br>Kobiety: -20 cm, Mƒô≈ºczy≈∫ni: -15 cm<br>Brak wyboru: u≈ºywamy ≈õredniej</p>
                </div>

                <div class="form-group">
                    <label class="form-label">Twoja waga (kg):</label>
                    <div class="slider-group">
                        <div class="slider-value-display" id="weight-display">60</div>
                        <input type="range" id="weight" min="15" max="200" value="60" oninput="updateSlider('weight')">
                    </div>
                </div>

                <div class="form-group">
                    <label class="form-label">Tw√≥j wzrost (cm):</label>
                    <div class="slider-group">
                        <div class="slider-value-display" id="height-display">170</div>
                        <input type="range" id="height" min="80" max="230" value="170" oninput="updateSlider('height')">
                    </div>
                </div>

                <div class="form-group">
                    <label class="form-label">Tw√≥j wiek:</label>
                    <div class="slider-group">

        <!-- -------------------- SCREEN: Results -------------------- -->
                        <div class="slider-value-display" id="age-display">25</div>
                        <input type="range" id="age" min="3" max="99" value="25" oninput="updateSlider('age')">
                    </div>
                </div>

                <button class="btn-skip" id="skip-form1" disabled onclick="skipToResults()">POMI≈É</button>
                <button class="btn btn-primary" id="next-form1" onclick="goToScreen('form2')">DALEJ ‚Üí</button>
            </div>
        </div>

        <!-- SCREEN 4: FORM 2/3 - LEVEL -->
        <div class="screen" id="screen-form2">
            <div class="header">
                <div class="header-nav">
                    <button class="btn-back" onclick="goBack()">‚Üê</button>
                    <span class="progress-indicator">[2/3]</span>
                    <div style="width:30px"></div>
                </div>
                <h2 class="header-title">Poziom jazdy</h2>
            </div>

            <div class="content">
                <div class="admob-banner" id="ad-form2">üì± AdMob Banner 300x50</div>

                <div class="card" onclick="selectLevel('beginner')">
                    <div class="card-icon">üå±</div>
                    <div class="card-title">POCZƒÑTKUJƒÑCY</div>
                    <div class="card-description">0-10 dni na desce/nartach</div>
                    <div class="card-checkmark">‚úì</div>
                </div>

                <div class="card" onclick="selectLevel('intermediate')">
                    <div class="card-icon">üéø</div>
                    <div class="card-title">≈öREDNIOZAAWANSOWANY</div>
                    <div class="card-description">10-30 dni, je≈∫dzisz pewnie</div>
                    <div class="card-checkmark">‚úì</div>
                </div>

                <div class="card" onclick="selectLevel('advanced')">
                    <div class="card-icon">‚ö°</div>
                    <div class="card-title">ZAAWANSOWANY</div>
                    <div class="card-description">30+ dni, r√≥≈ºne warunki</div>
                    <div class="card-checkmark">‚úì</div>
                </div>

                <div class="card" onclick="selectLevel('expert')">
                    <div class="card-icon">üî•</div>
                    <div class="card-title">EKSPERT</div>
                    <div class="card-description">Profesjonalista, instruktor</div>
                    <div class="card-checkmark">‚úì</div>
                </div>

                <button class="btn-skip" onclick="skipToResults()">POMI≈É</button>
                <button class="btn btn-primary" id="next-form2" disabled onclick="goToScreen('form3')">DALEJ ‚Üí</button>
            </div>
        </div>

        <!-- SCREEN 5: FORM 3/3 - STYLE -->
        <div class="screen" id="screen-form3">
            <div class="header">
                <div class="header-nav">
                    <button class="btn-back" onclick="goBack()">‚Üê</button>
                    <span class="progress-indicator">[3/3]</span>
                    <div style="width:30px"></div>
                </div>
                <h2 class="header-title">Styl jazdy</h2>
            </div>

            <div class="content">
                <div class="admob-banner" id="ad-form3">üì± AdMob Banner 300x50</div>
                <div id="style-cards-container"></div>

                <button class="btn-skip" onclick="skipToResults()">POMI≈É</button>
                <button class="btn btn-primary" id="next-form3" disabled onclick="calculateResults()">POKA≈ª WYNIKI üéØ</button>
            </div>
        </div>

        <!-- SCREEN 6: RESULTS -->
        <div class="screen" id="screen-results">
            <div class="header">
                <div class="header-nav">
                    <button class="btn-back" onclick="goToScreen('categories')">‚Üê</button>
                    <span id="result-category-title">üèÇ TWOJA IDEALNA DESKA</span>
                    <div style="width:30px"></div>
                </div>
            </div>

            <div class="content">
                <div class="admob-banner">üì± AdMob Banner 300x50</div>

                <div class="result-main">
                    <div class="result-label">üìè D≈ÅUGO≈öƒÜ</div>
                    <div>
                        <span class="result-value" id="result-length">156</span>
                        <span class="result-unit">cm</span>
                    </div>
                    <div class="result-range" id="result-range">(zakres: 153-159 cm)</div>
                </div>

        <!-- -------------------- SCREEN: DIN Calculator -------------------- -->

                <div class="result-advice">
                    <h3>üí¨ CZEGO SZUKAƒÜ W SKLEPIE:</h3>
                    <div id="advice-list"></div>
                </div>

                <div id="gender-hint-box" class="gender-hint" style="display: none;">
                    üí° Wskaz√≥wka: Wynik obliczony na podstawie ≈õredniej. Podanie p≈Çci mo≈ºe daƒá dok≈Çadniejszy wynik!
                </div>

                <button class="toggle-technical" id="toggle-tech" onclick="toggleTechnical()">
                    üîΩ Poka≈º parametry techniczne
                </button>

                <div class="tech-params" id="tech-params">
                    <div class="param-item">
                        <span class="param-label">Typ:</span>
                        <span class="param-value" id="tech-type">All-Mountain</span>
                    </div>
                    <div class="param-item">
                        <span class="param-label">Flex:</span>
                        <span class="param-value" id="tech-flex">Medium (5/10)</span>
                    </div>
                    <div class="param-item">
                        <span class="param-label">Profil:</span>
                        <span class="param-value" id="tech-profile">Hybrid</span>
                    </div>
                    <div class="param-item" id="tech-shape-row">
                        <span class="param-label">Shape:</span>
                        <span class="param-value" id="tech-shape">Directional Twin</span>
                    </div>
                </div>

                <div class="action-buttons">
                    <button class="btn-action" onclick="goToScreen('form1')">
                        ‚úèÔ∏è Edytuj moje dane
                    </button>
                    <button class="btn-action" onclick="startOver()">
                        üîÑ Zacznij od poczƒÖtku
                    </button>
                    <button class="btn-action">
                        üõí Kupiƒá sprzƒôt
                    </button>
                    <button class="btn-action">
                        üéø WynajƒÖƒá sprzƒôt
                    </button>
                    <button class="btn-action">
                        üéì Znale≈∫ƒá instruktora
                    </button>

        <!-- -------------------- SCREEN: DIN Results -------------------- -->
					<button class="btn-action" id="btn-calculate-din" onclick="goToScreen('din-form')" style="display: none;">
						‚öôÔ∏è Oblicz DIN
					</button>
                </div>
            </div>
        </div>

        <!-- SCREEN 7: DIN FORM -->
        <div class="screen" id="screen-din-form">
            <div class="header">
                <div class="header-nav">
                    <button class="btn-back" onclick="goToScreen('results')">‚Üê</button>
                    <span>Ustawienie wiƒÖza≈Ñ (DIN)</span>
                    <div style="width:30px"></div>
                </div>
            </div>

            <div class="content">
                <div style="padding: 16px; background: rgba(255, 165, 0, 0.1); border-radius: 12px; margin-bottom: 24px;">
                    <p style="font-size: 14px; line-height: 1.5;">DIN to ustawienie si≈Çy wypiƒôcia wiƒÖza≈Ñ narciarskich.</p>
                </div>

                <div class="form-group">
                    <label class="form-label">Rozmiar buta (Mondo):</label>
                    <input type="number" id="boot-size" placeholder="np. 27" step="0.5" min="20" max="35">
                    <p class="form-hint">üí° Mondo ‚âà EU minus 7 (EU 42 ‚âà Mondo 27)</p>
                </div>

                <div class="form-group">
                    <label class="form-label">Typ narciarza:</label>
                    <div class="radio-group">
                        <label class="radio-option">
                            <input type="radio" name="skier-type" value="cautious" onchange="updateRadioStyle()">
                            <span>Ostro≈ºny (wolƒô bezpiecze≈Ñstwo)</span>
                        </label>
                        <label class="radio-option">
                            <input type="radio" name="skier-type" value="average" onchange="updateRadioStyle()">
                            <span>Przeciƒôtny (normalny styl)</span>
                        </label>
                        <label class="radio-option">
                            <input type="radio" name="skier-type" value="aggressive" onchange="updateRadioStyle()">
                            <span>Agresywny (szybko, ostro)</span>
                        </label>
                    </div>
                </div>

                <div style="padding: 16px; background: rgba(255, 0, 0, 0.1); border-radius: 12px; margin: 24px 0;">
                    <p style="font-size: 13px; line-height: 1.5; color: #FF6666;">‚ö†Ô∏è WA≈ªNE: To TYLKO orientacyjna warto≈õƒá! Finalne ustawienie robi SERWIS w sklepie narciarskim.</p>
                </div>

                <button class="btn btn-secondary" onclick="goToScreen('results')">Anuluj</button>
                <button class="btn btn-primary" onclick="calculateDIN()">OBLICZ DIN ‚Üí</button>
            </div>
        </div>

        <!-- SCREEN 8: DIN RESULTS -->
        <div class="screen" id="screen-din-results">
            <div class="header">
                <div class="header-nav">
                    <button class="btn-back" onclick="goToScreen('results')">‚Üê</button>
                    <span>‚öôÔ∏è USTAWIENIE WIƒÑZA≈É</span>
                    <div style="width:30px"></div>
                </div>
            </div>

            <div class="content">
                <div class="result-main">
                    <div class="result-label">üéØ ZALECANE DIN:</div>
                    <div>
                        <span class="result-value" id="din-value">6.5</span>
                    </div>
                    <div class="result-range" id="din-range">(zakres: 6.0 - 7.0)</div>
                </div>

                <div class="result-advice">
                    <h3>Na podstawie:</h3>
                    <div id="din-basis"></div>
                </div>


    <!-- ==================== JAVASCRIPT: MAIN LOGIC ==================== -->
                <div style="padding: 20px; background: rgba(255, 0, 0, 0.1); border-radius: 12px; margin: 24px 0;">
                    <h3 style="font-size: 16px; margin-bottom: 12px; color: #FF6666;">‚ö†Ô∏è BARDZO WA≈ªNE:</h3>
                    <p style="font-size: 14px; line-height: 1.6;">
                        To TYLKO orientacyjna warto≈õƒá do rozmowy z serwisem!<br><br>
                        Finalne ustawienie DIN MUSI wykonaƒá certyfikowany SERWIS w sklepie narciarskim podczas monta≈ºu wiƒÖza≈Ñ.<br><br>
                        Nieprawid≈Çowe DIN = ryzyko powa≈ºnej kontuzji kolana!<br><br>
                        <strong>Nie pr√≥buj ustawiaƒá samodzielnie!</strong>
                    </p>

        <!-- -------------------- Settings & Theme -------------------- -->
                </div>

                <div class="action-buttons">
                    <button class="btn-action" onclick="copyDIN()">
                        üìã Skopiuj DIN
                    </button>
                    <button class="btn-action" onclick="goToScreen('results')">
                        ‚Üê Wr√≥ƒá do wynik√≥w
                    </button>
                </div>
            </div>
        </div>
		<!-- ==================== SCREEN: Business Register ==================== -->
		<div id="screen-business-register" class="screen">
			<div class="header">
				<div class="header-nav">
					<button class="btn-back" onclick="goToScreen('launch')">‚Üê</button>
					<span class="progress-indicator">Konto biznesowe</span>
					<div style="width: 44px;"></div>
				</div>
				<div class="header-title">üè¢ Rejestracja firmy</div>
			</div>

			<div class="content">

				<!-- KROK 1: Typ firmy -->
				<div id="biz-step-1" class="biz-step">
					<p class="form-label" style="margin-bottom: 20px;">Kim jeste≈õ?</p>

					<div class="card" id="biz-type-rental" onclick="selectBizType('rental')" style="cursor:pointer; margin-bottom: 12px;">
						<div class="card-title">üéø Wypo≈ºyczalnia sprzƒôtu</div>
						<div class="card-description">Wynajmujesz deski, narty, buty i akcesoria</div>
					</div>

					<div class="card" id="biz-type-instructor" onclick="selectBizType('instructor')" style="cursor:pointer; margin-bottom: 12px;">
						<div class="card-title">üéì Instruktor</div>
						<div class="card-description">Prowadzisz lekcje jako osoba fizyczna</div>
					</div>

					<div class="card" id="biz-type-school" onclick="selectBizType('school')" style="cursor:pointer; margin-bottom: 12px;">
						<div class="card-title">üè´ Szk√≥≈Çka</div>
						<div class="card-description">Prowadzisz szk√≥≈Çkƒô z instruktorami</div>
					</div>

					<div class="card" id="biz-type-shop" onclick="selectBizType('shop')" style="cursor:pointer; margin-bottom: 12px;">
						<div class="card-title">üõí Sklep sportowy</div>
						<div class="card-description">Sprzedajesz sprzƒôt sportowy</div>
					</div>

					<button class="btn btn-primary" id="biz-btn-step1" onclick="bizGoToStep(2)" disabled style="width: 100%; margin-top: 8px;">
						Dalej ‚Üí
					</button>
				</div>

				<!-- KROK 2: Dane firmy -->
				<div id="biz-step-2" class="biz-step" style="display:none;">
					<p class="form-label" style="margin-bottom: 20px;">Dane firmy</p>

					<div class="form-group">
						<label class="form-label">Nazwa firmy *</label>
						<input type="text" id="biz-name" class="form-input" placeholder="np. Ski Rental Zakopane">
					</div>

					<div class="form-group">
						<label class="form-label">NIP</label>
						<input type="text" id="biz-nip" class="form-input" placeholder="np. 1234567890">
					</div>

					<div class="form-group">
						<label class="form-label">Miasto *</label>
						<input type="text" id="biz-city" class="form-input" placeholder="np. Zakopane">
					</div>

					<div class="form-group">
						<label class="form-label">Adres</label>
						<input type="text" id="biz-address" class="form-input" placeholder="np. ul. Krup√≥wki 1">
					</div>

					<div class="form-group">
						<label class="form-label">Telefon *</label>
						<input type="tel" id="biz-phone" class="form-input" placeholder="np. 600123456">
					</div>

					<div class="form-group">
						<label class="form-label">Email firmowy *</label>
						<input type="email" id="biz-email" class="form-input" placeholder="np. kontakt@firma.pl">
					</div>

					<div class="form-group">
						<label class="form-label">Opis dzia≈Çalno≈õci</label>
						<textarea id="biz-description" class="form-input" rows="3" placeholder="Kr√≥tko opisz swojƒÖ ofertƒô..."></textarea>
					</div>

					<div class="form-group">
						<label class="form-label">Godziny otwarcia</label>
						<input type="text" id="biz-hours" class="form-input" placeholder="np. Pon-Pt 9:00-17:00, Sb 9:00-14:00">
					</div>

					<div style="display: flex; gap: 12px; margin-top: 8px;">
						<button class="btn btn-secondary" onclick="bizGoToStep(1)" style="flex: 1;">
							‚Üê Wstecz
						</button>
						<button class="btn btn-primary" id="biz-btn-step2" onclick="bizGoToStep(3)" disabled style="flex: 2;">
							Dalej ‚Üí
						</button>
					</div>
				</div>

				<!-- KROK 3: Kategorie + Szko≈Ça (dla instruktora) + Regulamin -->
				<div id="biz-step-3" class="biz-step" style="display:none;">

					<p class="form-label" style="margin-bottom: 12px;">Kategorie sportowe *</p>
					<div style="margin-bottom: 20px;">
						<div class="card" id="biz-cat-snowboard" onclick="toggleBizCategory('snowboard')" style="cursor:pointer; margin-bottom: 8px; padding: 14px;">
							<div style="display:flex; justify-content:space-between; align-items:center;">
								<span>üèÇ Snowboard</span>
								<span id="biz-cat-snowboard-check" style="display:none; color:#00D9FF;">‚úì</span>
							</div>
						</div>
						<div class="card" id="biz-cat-ski" onclick="toggleBizCategory('ski')" style="cursor:pointer; margin-bottom: 8px; padding: 14px;">
							<div style="display:flex; justify-content:space-between; align-items:center;">
								<span>‚õ∑Ô∏è Ski</span>
								<span id="biz-cat-ski-check" style="display:none; color:#00D9FF;">‚úì</span>
							</div>
						</div>
						<div class="card" style="opacity:0.4; margin-bottom: 8px; padding: 14px;">
							<div style="display:flex; justify-content:space-between; align-items:center;">
								<span>ü™Å Kite</span>
								<span style="font-size:12px; color:#666;">üöß SOON</span>
							</div>
						</div>
						<div class="card" style="opacity:0.4; margin-bottom: 8px; padding: 14px;">
							<div style="display:flex; justify-content:space-between; align-items:center;">
								<span>üèÑ Wake</span>
								<span style="font-size:12px; color:#666;">üöß SOON</span>
							</div>
						</div>
					</div>

					<!-- Tylko dla instruktora: wyb√≥r szk√≥≈Çki -->
					<div id="biz-school-section" style="display:none;">
						<p class="form-label" style="margin-bottom: 12px;">Czy nale≈ºysz do szk√≥≈Çki?</p>
						<div style="margin-bottom: 20px;">
							<label style="display:flex; align-items:center; gap:12px; margin-bottom:12px; cursor:pointer;">
								<input type="radio" name="biz-school" value="none" checked onchange="toggleSchoolSelect(this.value)">
								<span>Nie, jestem freelancerem</span>
							</label>
							<label style="display:flex; align-items:center; gap:12px; cursor:pointer;">
								<input type="radio" name="biz-school" value="select" onchange="toggleSchoolSelect(this.value)">
								<span>Tak, nale≈ºƒô do szk√≥≈Çki</span>
							</label>
							<div id="biz-school-select-wrap" style="display:none; margin-top:12px;">
								<select id="biz-school-id" class="form-input">
									<option value="">-- Wybierz szk√≥≈Çkƒô --</option>
								</select>
							</div>
						</div>
					</div>

					<!-- Regulamin -->
					<div style="margin-bottom: 20px;">
						<label style="display:flex; align-items:flex-start; gap:12px; cursor:pointer;">
							<input type="checkbox" id="biz-terms" onchange="validateBizStep3()" style="margin-top:3px; flex-shrink:0;">
							<span style="font-size:14px; color:#B0B0B0;">Akceptujƒô regulamin aplikacji i politykƒô prywatno≈õci DuckOnBoard</span>
						</label>
					</div>

					<div style="display: flex; gap: 12px;">
						<button class="btn btn-secondary" onclick="bizGoToStep(2)" style="flex: 1;">
							‚Üê Wstecz
						</button>
						<button class="btn btn-primary" id="biz-btn-step3" onclick="submitBusinessRegistration()" disabled style="flex: 2;">
							Zarejestruj firmƒô
						</button>
					</div>
				</div>

				<!-- POTWIERDZENIE -->
				<div id="biz-step-confirm" class="biz-step" style="display:none; text-align:center; padding: 40px 20px;">
					<div style="font-size: 64px; margin-bottom: 20px;">üéâ</div>
					<h2 style="color: #00D9FF; margin-bottom: 16px;">Rejestracja wys≈Çana!</h2>
					<p style="color: #B0B0B0; margin-bottom: 12px;">Twoje konto biznesowe zosta≈Ço utworzone i oczekuje na weryfikacjƒô.</p>
					<p style="color: #B0B0B0; margin-bottom: 32px; font-size: 14px;">Skontaktujemy siƒô z TobƒÖ w ciƒÖgu 24-48 godzin.</p>
					<button class="btn btn-primary" onclick="goToScreen('launch')" style="width: 100%;">
						Wr√≥ƒá do logowania
					</button>
				</div>

			</div>
		</div>
		<!-- ==================== END: Business Register ==================== -->		
    </div>

    <script>
        // STATE
        const state = {
            isLoggedIn: false,
            category: null,
            gender: null,
            weight: 60,
            height: 170,
            age: 25,
            level: null,
            style: null,
            screenHistory: []
        };

        // INIT
        window.addEventListener('load', () => {
            loadTheme();
            validateForm1();
        });

        // THEME
        function loadTheme() {
            const saved = localStorage.getItem('duckonboard-theme') || 'standard-dark';
            changeTheme(saved);
        }

        function changeTheme(theme) {
            document.body.className = 'theme-' + theme;
            localStorage.setItem('duckonboard-theme', theme);

        /* -------------------- Authentication: Login Functions -------------------- */
            
            document.querySelectorAll('.theme-option').forEach(opt => {
                opt.classList.remove('active');
                if (opt.dataset.theme === theme) {
                    opt.classList.add('active');
                }
            });

            const logo = document.getElementById('mainLogo');
            if (logo && theme === 'pride') {
                logo.src = 'logo-pride.png';
            } else if (logo) {
                logo.src = 'logo-standard.png';
            }
        }

        function openSettings() {
            document.getElementById('settingsModal').classList.add('active');
        }

        function closeSettings() {

        /* -------------------- Authentication: Logout -------------------- */
            document.getElementById('settingsModal').classList.remove('active');
        }

        // NAVIGATION
        function goToScreen(screenId) {
            document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
            document.getElementById('screen-' + screenId).classList.add('active');
            
            // CRITICAL: Scroll to top
            window.scrollTo({ top: 0, behavior: 'instant' });
            document.body.scrollTop = 0;
            document.documentElement.scrollTop = 0;
            
            const container = document.querySelector('.app-container');
            if (container) container.scrollTop = 0;
        }

        function goBack() {
            const currentScreen = document.querySelector('.screen.active').id;
            
            if (currentScreen === 'screen-form1') goToScreen('categories');
            else if (currentScreen === 'screen-form2') goToScreen('form1');
            else if (currentScreen === 'screen-form3') goToScreen('form2');
            else if (currentScreen === 'screen-results') goToScreen('form3');
            else if (currentScreen === 'screen-din-form') goToScreen('results');
            else if (currentScreen === 'screen-din-results') goToScreen('results');
            else if (currentScreen === 'screen-categories') goToScreen('launch');
        }

        function startOver() {
            state.category = null;
            state.level = null;
            state.style = null;
            document.querySelectorAll('.card').forEach(c => c.classList.remove('selected'));
            goToScreen('launch');
        }

		// Aktualizuj info o u≈ºytkowniku w Settings
		async function startAnonymous() {
			try {
				await window.firebaseSignInAnonymously();
				goToScreen('categories');
			} catch (error) {
				console.error('B≈ÇƒÖd logowania anonimowego:', error);
				alert('B≈ÇƒÖd: ' + error.message);
			}
		}

		async function loginGoogle() {
			try {
				await window.firebaseSignInWithPopup(window.firebaseGoogleProvider);
				goToScreen('categories');
			} catch (error) {
				console.error('B≈ÇƒÖd logowania Google:', error);
				alert('B≈ÇƒÖd: ' + error.message);
			}
		}

		async function handleLogout() {
			try {
				await window.firebaseSignOut();
				alert('Wylogowano pomy≈õlnie!');
				goToScreen('launch');
				closeSettings();
			} catch (error) {
				console.error('B≈ÇƒÖd wylogowania:', error);
				alert('B≈ÇƒÖd wylogowania: ' + error.message);
			}

        /* -------------------- Authentication: Email/Password -------------------- */
		}

		// EMAIL LOGOWANIE
		let isLoginMode = true;

		function showEmailForm() {
			const formSection = document.getElementById('emailFormSection');
			formSection.style.display = formSection.style.display === 'none' ? 'block' : 'none';
		}

		function toggleAuthMode() {
			isLoginMode = !isLoginMode;
			const authBtn = document.getElementById('emailAuthBtn');
			const toggleText = document.getElementById('toggleText');
			
			if (isLoginMode) {
				authBtn.textContent = 'Zaloguj siƒô';
				toggleText.textContent = 'Zarejestruj siƒô';
			} else {
				authBtn.textContent = 'Zarejestruj siƒô';
				toggleText.textContent = 'Zaloguj siƒô';
			}
			
			hideError();
		}

		async function handleEmailAuth() {
			const email = document.getElementById('emailInput').value.trim();
			const password = document.getElementById('passwordInput').value;
			
			if (!email || !password) {
				showError('Wype≈Çnij wszystkie pola');
				return;
			}
			
			if (password.length < 6) {
				showError('Has≈Ço musi mieƒá minimum 6 znak√≥w');
				return;
			}
			
			try {
				const auth = window.firebaseAuth;
				
				if (isLoginMode) {
					// Logowanie
					const { signInWithEmailAndPassword } = await import('https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js');
					await signInWithEmailAndPassword(auth, email, password);
				} else {
					// Rejestracja
					const { createUserWithEmailAndPassword } = await import('https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js');
					await createUserWithEmailAndPassword(auth, email, password);
				}
				
				// Wyczy≈õƒá formularz
				document.getElementById('emailInput').value = '';
				document.getElementById('passwordInput').value = '';
				hideError();
				
				// Przejd≈∫ do kategorii (automatycznie przez onAuthStateChanged)
				
			} catch (error) {
				console.error('B≈ÇƒÖd email auth:', error);
				
				if (error.code === 'auth/email-already-in-use') {
					showError('Ten email jest ju≈º zarejestrowany');
				} else if (error.code === 'auth/invalid-email') {
					showError('Nieprawid≈Çowy format email');
				} else if (error.code === 'auth/user-not-found') {
					showError('Nie znaleziono u≈ºytkownika');
				} else if (error.code === 'auth/wrong-password') {
					showError('Nieprawid≈Çowe has≈Ço');
				} else if (error.code === 'auth/invalid-credential') {
					showError('Nieprawid≈Çowy email lub has≈Ço');
				} else {
					showError('B≈ÇƒÖd: ' + error.message);
				}
			}
		}

		function showError(message) {
			const errorDiv = document.getElementById('errorMessage');
			errorDiv.textContent = message;
			errorDiv.style.display = 'block';
			
			setTimeout(() => {
				hideError();
			}, 5000);
		}

		function hideError() {
			const errorDiv = document.getElementById('errorMessage');
			errorDiv.style.display = 'none';
		}


        /* -------------------- Navigation & Categories -------------------- */
		function loginEmail() {
			showEmailForm();
		}

		function loginFacebook() {
			alert('Facebook login - wkr√≥tce!');
		}

		function loginApple() {
			alert('Apple login - wkr√≥tce!');
		}
		
		/*
		// Observer stanu u≈ºytkownika
		window.onAuthStateChanged(window.firebaseAuth, (user) => {
			if (user) {
				console.log('Zalogowany:', user.email || user.uid);
			} else {
				console.log('Wylogowany');
			}
		});
		*/
        // CATEGORIES
        function selectCategory(category) {
            if (['kite', 'wake', 'surf', 'sup', 'tennis', 'bike'].includes(category)) {
                showToast('üöß Ta kategoria jest w trakcie budowy! Coming soon.');
                return;
            }
            
            state.category = category;
            populateStyleCards(category);
            goToScreen('form1');
        }

        function populateStyleCards(category) {
            const styles = {
                snowboard: [
                    { value: 'allmountain', icon: 'üèîÔ∏è', title: 'ALL-MOUNTAIN', desc: 'Wszƒôdzie - stok, r√≥≈ºne warunki' },
                    { value: 'freestyle', icon: 'üé™', title: 'FREESTYLE', desc: 'Skoki, trick\'i, park' },
                    { value: 'freeride', icon: '‚õ∞Ô∏è', title: 'FREERIDE', desc: 'Poza trasƒÖ, g≈Çƒôboki ≈õnieg' },
                    { value: 'powder', icon: '‚ùÑÔ∏è', title: 'POWDER', desc: 'Bardzo g≈Çƒôboki ≈õnieg' }
                ],

        /* -------------------- Form Validation & UI Updates -------------------- */
                ski: [
                    { value: 'allmountain', icon: 'üèîÔ∏è', title: 'ALL-MOUNTAIN', desc: 'Wszƒôdzie - stok, r√≥≈ºne warunki' },
                    { value: 'freestyle', icon: 'üé™', title: 'FREESTYLE', desc: 'Skoki, trick\'i, park' },
                    { value: 'freeride', icon: '‚õ∞Ô∏è', title: 'FREERIDE', desc: 'Poza trasƒÖ, g≈Çƒôboki ≈õnieg' },
                    { value: 'carving', icon: 'üèÅ', title: 'CARVING', desc: 'Szybkie przejazdy, slalom' },
                    { value: 'touring', icon: 'ü•æ', title: 'TOURING', desc: 'Skitouring, wyprawy' }
                ]
            };

            const container = document.getElementById('style-cards-container');
            const categoryStyles = styles[category] || styles.snowboard;
            
            container.innerHTML = categoryStyles.map(s => `
                <div class="card" onclick="selectStyle('${s.value}')">
                    <div class="card-icon">${s.icon}</div>
                    <div class="card-title">${s.title}</div>
                    <div class="card-description">${s.desc}</div>
                    <div class="card-checkmark">‚úì</div>
                </div>
            `).join('');
        }

        // FORM
        function updateSlider(id) {
            const value = document.getElementById(id).value;
            document.getElementById(id + '-display').textContent = value;
            state[id] = parseFloat(value);
            validateForm1();
        }

        function validateForm1() {
            const valid = state.weight >= 15 && state.height >= 80 && state.age >= 3;
            document.getElementById('next-form1').disabled = !valid;
            document.getElementById('skip-form1').disabled = !valid;
            
            const genderInput = document.querySelector('input[name="gender"]:checked');
            state.gender = genderInput ? genderInput.value : null;
        }

        function updateRadioStyle() {
            document.querySelectorAll('.radio-option').forEach(option => {
                const radio = option.querySelector('input[type="radio"]');
                option.classList.toggle('checked', radio && radio.checked);
            });
            validateForm1();
        }

        function selectLevel(level) {
            state.level = level;
            document.querySelectorAll('#screen-form2 .card').forEach(c => c.classList.remove('selected'));
            event.target.closest('.card').classList.add('selected');
            document.getElementById('next-form2').disabled = false;
        }

        function selectStyle(style) {
            state.style = style;
            document.querySelectorAll('#screen-form3 .card').forEach(c => c.classList.remove('selected'));
            event.target.closest('.card').classList.add('selected');
            document.getElementById('next-form3').disabled = false;
        }

        function skipToResults() {
            if (!state.level) state.level = 'intermediate';

        /* -------------------- Calculations: Algorithms -------------------- */
            if (!state.style) state.style = 'allmountain';
            calculateResults();
        }

        // CALCULATIONS
        function calculateResults() {
            const { category, gender, weight, height, age, level, style } = state;
            
            let result;
            if (category === 'ski') {
                result = calculateSkiLength(height, weight, age, gender, level, style);
            } else {
                result = calculateSnowboardLength(height, weight, age, level, style);
            }
            
            displayResults(result);
			// Show/hide DIN button
			const dinBtn = document.getElementById('btn-calculate-din');
			if (dinBtn) {
				dinBtn.style.display = state.category === 'ski' ? 'flex' : 'none';
			}
        }

        function calculateSkiLength(height, weight, age, gender, level, style) {
            let baseLength = height;
            
            if (level === 'beginner') {
                baseLength -= 20;
            } else if (level === 'intermediate') {
                if (gender === 'female') baseLength -= 20;
                else if (gender === 'male') baseLength -= 15;
                else baseLength -= 17;
            } else if (level === 'advanced') {
                if (gender === 'female') baseLength -= 15;
                else if (gender === 'male') baseLength -= 10;
                else baseLength -= 12;
            } else if (level === 'expert') {
                baseLength -= 5;
            }
            
            const multiplier = (gender === 'female') ? 0.85 : 0.9;
            const expectedWeight = (height - 100) * multiplier;
            
            if (weight > expectedWeight * 1.2) baseLength += 5;
            else if (weight < expectedWeight * 0.8) baseLength -= 5;
            
            if (style === 'freestyle') baseLength -= 5;
            else if (style === 'freeride') baseLength += 5;
            else if (style === 'carving') baseLength -= 5;
            
            const skiLength = Math.round(baseLength);
            const diff = height - skiLength;
            
            return {
                length: skiLength,
                rangeMin: skiLength - 5,
                rangeMax: skiLength + 5,
                description: `${diff} cm kr√≥tsze od wzrostu`
            };
        }

        function calculateSnowboardLength(height, weight, age, level, style) {
            let baseLength = height - 15;
            
            if (age < 15) {
                baseLength = height - 25;
            } else if (level === 'beginner') {
                baseLength -= 5;
            } else if (level === 'expert') {
                baseLength += 5;
            }
            
            const expectedWeight = (height - 100) * 0.9;
            if (weight > expectedWeight * 1.2) baseLength += 3;
            else if (weight < expectedWeight * 0.8) baseLength -= 3;
            
            if (style === 'freestyle') baseLength -= 3;
            else if (style === 'freeride' || style === 'powder') baseLength += 3;
            
            const boardLength = Math.round(baseLength);
            
            return {
                length: boardLength,
                rangeMin: boardLength - 3,
                rangeMax: boardLength + 3,
                description: `${height - boardLength} cm kr√≥tsze od wzrostu`
            };
        }

        function displayResults(result) {
            document.getElementById('result-length').textContent = result.length;
            document.getElementById('result-range').textContent = `(zakres: ${result.rangeMin}-${result.rangeMax} cm)`;
            
            const title = state.category === 'ski' ? '‚õ∑Ô∏è TWOJE IDEALNE NARTY' : 'üèÇ TWOJA IDEALNA DESKA';
            document.getElementById('result-category-title').textContent = title;
            
            const levelNames = {
                beginner: 'poczƒÖtkujƒÖcych',
                intermediate: '≈õredniozaawansowanych',
                advanced: 'zaawansowanych',
                expert: 'ekspert√≥w'
            };
            
            const styleNames = {
                allmountain: state.category === 'ski' ? 'Narty all-mountain' : 'Deska all-mountain',
                freestyle: state.category === 'ski' ? 'Narty freestyle' : 'Deska freestyle',
                freeride: state.category === 'ski' ? 'Narty freeride' : 'Deska freeride',
                powder: 'Deska powder',
                carving: 'Narty carving',
                touring: 'Narty touring'

        /* -------------------- Results Display -------------------- */
            };
            
            const advice = [
                styleNames[state.style] || 'Uniwersalna',
                `Dla ${levelNames[state.level]}`,
                '≈örednia twardo≈õƒá (medium)'
            ];
            
            document.getElementById('advice-list').innerHTML = advice.map(a => `
                <div class="result-advice-item"><span>‚úÖ</span><span>${a}</span></div>
            `).join('');
            
            document.getElementById('gender-hint-box').style.display = state.gender ? 'none' : 'block';
            
            if (state.category === 'snowboard') {
                document.getElementById('tech-shape-row').style.display = 'flex';
            } else {
                document.getElementById('tech-shape-row').style.display = 'none';
            }
            
            goToScreen('results');
        }

        function toggleTechnical() {
            const params = document.getElementById('tech-params');
            const btn = document.getElementById('toggle-tech');
            
            if (params.classList.contains('visible')) {
                params.classList.remove('visible');
                btn.textContent = 'üîΩ Poka≈º parametry techniczne';
            } else {
                params.classList.add('visible');
                btn.textContent = 'üîº Ukryj parametry techniczne';
            }
        }

        // DIN
        function calculateDIN() {
            const bootSize = parseFloat(document.getElementById('boot-size').value);
            const skierTypeInput = document.querySelector('input[name="skier-type"]:checked');
            
            if (!bootSize || !skierTypeInput) {
                showToast('‚ö†Ô∏è Wype≈Çnij wszystkie pola!');
                return;
            }
            
            const skierType = skierTypeInput.value;
            const { weight, age, level } = state;
            
            let din = Math.floor(weight / 10);
            
            if (bootSize < 25) din -= 0.5;
            if (bootSize > 31) din += 0.5;
            
            if (skierType === 'cautious') din -= 1;
            if (skierType === 'aggressive') din += 1;
            

        /* -------------------- DIN Calculator -------------------- */
            if (age >= 50) din -= 1;
            if (level === 'beginner') din -= 0.5;
            
            if (din < 2) din = 2;
            if (din > 12) din = 12;
            
            din = Math.round(din * 2) / 2;
            
            document.getElementById('din-value').textContent = din;
            document.getElementById('din-range').textContent = `(zakres: ${din - 0.5} - ${din + 0.5})`;
            

        /* -------------------- Utilities: Toast -------------------- */
            const typeNames = { cautious: 'Ostro≈ºny', average: 'Przeciƒôtny', aggressive: 'Agresywny' };
            
            document.getElementById('din-basis').innerHTML = `
                <div class="result-advice-item"><span>‚Ä¢</span><span>Waga: ${weight} kg</span></div>
                <div class="result-advice-item"><span>‚Ä¢</span><span>Rozmiar buta: ${bootSize} Mondo</span></div>
                <div class="result-advice-item"><span>‚Ä¢</span><span>Typ: ${typeNames[skierType]}</span></div>
                <div class="result-advice-item"><span>‚Ä¢</span><span>Wiek: ${age} lat</span></div>
            `;
            
            goToScreen('din-results');
        }

    /*-- ==================== FIREBASE SDK ==================== --*/

        function copyDIN() {
            const din = document.getElementById('din-value').textContent;
            const range = document.getElementById('din-range').textContent;
            const text = `DIN: ${din} ${range}\n‚ö†Ô∏è ORIENTACYJNIE - finalne ustawienie robi SERWIS!`;
            
            navigator.clipboard.writeText(text).then(() => {
                showToast('‚úÖ Skopiowano do schowka!');
            });
        }

		// ==================== BUSINESS REGISTER ====================

		let bizState = {
			type: null,
			categories: []
		};

		function selectBizType(type) {
			bizState.type = type;

			// Reset wszystkich kart
			['rental', 'instructor', 'school', 'shop'].forEach(t => {
				const card = document.getElementById('biz-type-' + t);
				if (card) card.classList.remove('biz-type-selected');
			});

			// Zaznacz wybranƒÖ
			const selected = document.getElementById('biz-type-' + type);
			if (selected) selected.classList.add('biz-type-selected');

			// Aktywuj przycisk Dalej
			document.getElementById('biz-btn-step1').disabled = false;
		}

		function bizGoToStep(step) {
			// Walidacja kroku 2
			if (step === 3) {
				const name = document.getElementById('biz-name').value.trim();
				const city = document.getElementById('biz-city').value.trim();
				const phone = document.getElementById('biz-phone').value.trim();
				const email = document.getElementById('biz-email').value.trim();
				if (!name || !city || !phone || !email) {
					showToast('‚ö†Ô∏è Wype≈Çnij wymagane pola (*)');
					return;
				}
			}

			// Ukryj wszystkie kroki
			['1', '2', '3', 'confirm'].forEach(s => {
				const el = document.getElementById('biz-step-' + s);
				if (el) el.style.display = 'none';
			});

			// Poka≈º w≈Ça≈õciwy krok
			const target = document.getElementById('biz-step-' + step);
			if (target) target.style.display = 'block';

			// Poka≈º sekcjƒô szk√≥≈Çki tylko dla instruktora
			if (step === 3) {
				const schoolSection = document.getElementById('biz-school-section');
				if (schoolSection) {
					schoolSection.style.display = bizState.type === 'instructor' ? 'block' : 'none';
				}
				// Za≈Çaduj listƒô szk√≥≈Çek je≈õli instruktor
				if (bizState.type === 'instructor') {
					loadSchoolsList();
				}
				validateBizStep3();
			}

			window.scrollTo({ top: 0, behavior: 'instant' });
		}

		function toggleBizCategory(cat) {
			const idx = bizState.categories.indexOf(cat);
			const card = document.getElementById('biz-cat-' + cat);
			const check = document.getElementById('biz-cat-' + cat + '-check');

			if (idx === -1) {
				bizState.categories.push(cat);
				if (card) card.classList.add('biz-cat-selected');
				if (check) check.style.display = 'block';
			} else {
				bizState.categories.splice(idx, 1);
				if (card) card.classList.remove('biz-cat-selected');
				if (check) check.style.display = 'none';
			}

			validateBizStep3();
		}

		function toggleSchoolSelect(value) {
			const wrap = document.getElementById('biz-school-select-wrap');
			if (wrap) {
				wrap.style.display = value === 'select' ? 'block' : 'none';
			}
		}

		async function loadSchoolsList() {
			try {
				const select = document.getElementById('biz-school-id');
				if (!select) return;

				const q = window.firestoreQuery(
					window.firestoreCollection(window.firebaseDb, 'schools'),
					window.firestoreWhere('status', '==', 'approved')
				);

				const snapshot = await window.firestoreGetDocs(q);
				select.innerHTML = '<option value="">-- Wybierz szk√≥≈Çkƒô --</option>';

				snapshot.forEach(doc => {
					const data = doc.data();
					const option = document.createElement('option');
					option.value = doc.id;
					option.textContent = data.name + ' (' + data.city + ')';
					select.appendChild(option);
				});

				if (snapshot.empty) {
					select.innerHTML = '<option value="">Brak zarejestrowanych szk√≥≈Çek</option>';
				}
			} catch (error) {
				console.error('B≈ÇƒÖd ≈Çadowania szk√≥≈Çek:', error);
			}
		}

		function validateBizStep3() {
			const hasCategory = bizState.categories.length > 0;
			const hasTerms = document.getElementById('biz-terms')?.checked;
			const btn = document.getElementById('biz-btn-step3');
			if (btn) btn.disabled = !(hasCategory && hasTerms);
		}

		async function submitBusinessRegistration() {
			try {
				const auth = window.firebaseAuth;
				const user = auth.currentUser;

				if (!user) {
					showToast('‚ö†Ô∏è Musisz byƒá zalogowany');
					return;
				}

				const name = document.getElementById('biz-name').value.trim();
				const nip = document.getElementById('biz-nip').value.trim();
				const city = document.getElementById('biz-city').value.trim();
				const address = document.getElementById('biz-address').value.trim();
				const phone = document.getElementById('biz-phone').value.trim();
				const email = document.getElementById('biz-email').value.trim();
				const description = document.getElementById('biz-description').value.trim();
				const hours = document.getElementById('biz-hours').value.trim();

				// Szk√≥≈Çka dla instruktora
				let schoolId = null;
				if (bizState.type === 'instructor') {
					const schoolRadio = document.querySelector('input[name="biz-school"]:checked');
					if (schoolRadio && schoolRadio.value === 'select') {
						schoolId = document.getElementById('biz-school-id').value || null;
					}
				}

				// Dane wsp√≥lne
				const bizData = {
					type: bizState.type,
					name: name,
					nip: nip,
					city: city,
					address: address,
					phone: phone,
					email: email,
					description: description,
					openingHours: hours,
					categories: bizState.categories,
					status: 'pending',
					logoUrl: '',
					galleryUrls: [],
					rating: 0,
					reviewsCount: 0,
					followers: [],
					createdAt: window.firebaseServerTimestamp()
				};

				// Dodaj schoolId dla instruktora
				if (bizState.type === 'instructor') {
					bizData.schoolId = schoolId;
					bizData.avatarUrl = '';
					bizData.certifications = [];
					bizData.pricePerHour = { child: 0, junior: 0, adult: 0 };
					bizData.availability = [];
				}

				// Wyb√≥r kolekcji
				const collectionName = bizState.type === 'school' ? 'schools' :
									   bizState.type === 'instructor' ? 'instructors' : 'businesses';

				// Zapis do Firestore
				await window.firestoreSetDoc(
					window.firestoreDoc(window.firebaseDb, collectionName, user.uid),
					bizData
				);

				// Zapis roli w users
				await window.firestoreSetDoc(
					window.firestoreDoc(window.firebaseDb, 'users', user.uid),
					{
						role: 'partner',
						accountType: 'business',
						businessType: bizState.type,
						email: user.email || email,
						createdAt: window.firebaseServerTimestamp()
					}
				);

				// Poka≈º potwierdzenie
				['1', '2', '3'].forEach(s => {
					const el = document.getElementById('biz-step-' + s);
					if (el) el.style.display = 'none';
				});
				document.getElementById('biz-step-confirm').style.display = 'block';
				window.scrollTo({ top: 0, behavior: 'instant' });

			} catch (error) {
				console.error('B≈ÇƒÖd rejestracji biznesowej:', error);
				showToast('‚ùå B≈ÇƒÖd: ' + error.message);
			}
		}

        // TOAST
        function showToast(message) {
            const toast = document.getElementById('toast');
            toast.textContent = message;
            toast.classList.add('show');
            
            setTimeout(() => {
                toast.classList.remove('show');
            }, 3000);
        }
    </script>
	<!-- Firebase SDK -->
    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js';
		import { 
			getFirestore,
			doc,
			setDoc,
			getDoc,
			updateDoc,
			collection,
			query,
			where,
			getDocs,
			serverTimestamp
		} from 'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';
        import { 
            getAuth, 
            signInWithPopup, 
            GoogleAuthProvider,
            signInWithEmailAndPassword,
            createUserWithEmailAndPassword,
            signInAnonymously,
            signOut,
            onAuthStateChanged
        } from 'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';

        // Firebase Configuration
        const firebaseConfig = {
            apiKey: "AIzaSyCkiDc3UJzz9ooUzRZ55HWh9ms-cF4YFWI",
            authDomain: "duckonboard-69a2b.firebaseapp.com",
            projectId: "duckonboard-69a2b",
            storageBucket: "duckonboard-69a2b.firebasestorage.app",
            messagingSenderId: "299574361615",
            appId: "1:299574361615:web:5228c5c18821874864ed7a",
            measurementId: "G-S0XDYWS6CF"
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const googleProvider = new GoogleAuthProvider();
		const db = getFirestore(app);

    
		// Udostƒôpnij Firebase globalnie
		window.firebaseAuth = auth;
		window.firebaseGoogleProvider = googleProvider;

		// Funkcje logowania
		window.firebaseSignInAnonymously = () => signInAnonymously(auth);
		window.firebaseSignInWithPopup = (provider) => signInWithPopup(auth, provider);
		window.firebaseSignOut = () => signOut(auth);
		window.firebaseDb = db;
		window.firebaseServerTimestamp = serverTimestamp;
		window.firestoreDoc = doc;
		window.firestoreSetDoc = setDoc;
		window.firestoreGetDoc = getDoc;
		window.firestoreUpdateDoc = updateDoc;
		window.firestoreCollection = collection;
		window.firestoreQuery = query;
		window.firestoreWhere = where;
		window.firestoreGetDocs = getDocs;

		// Observer - uruchom od razu
		onAuthStateChanged(auth, (user) => {
			const userSection = document.getElementById('userAccountSection');
			const userName = document.getElementById('userNameDisplay');
			const userEmail = document.getElementById('userEmailDisplay');
			
			console.log('Auth state changed:', user ? (user.email || 'Anonimowy') : 'Wylogowany');
/* ==================== KONIEC FIREBASE SDK ==================== */
			
			if (user) {
				// U≈ºytkownik zalogowany
				if (userSection) userSection.style.display = 'block';
				
				if (user.isAnonymous) {
					if (userName) userName.textContent = 'üë§ Go≈õƒá';
					if (userEmail) userEmail.textContent = 'Tryb anonimowy';
				} else {
					if (userName) userName.textContent = user.displayName || user.email.split('@')[0];
					if (userEmail) userEmail.textContent = user.email || '';
				}
				
				// Je≈õli jeste≈õ na ekranie logowania - przejd≈∫ do kategorii
				const currentScreen = document.querySelector('.screen.active');
				if (currentScreen && currentScreen.id === 'screen-launch') {
					goToScreen('categories');
				}
			} else {
				// U≈ºytkownik wylogowany
				if (userSection) userSection.style.display = 'none';
			}
		});
    </script>
</body>
</html>
